(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s}_getTemplate(){return document.querySelector("#elements__card-template").content.querySelector(".elements__card").cloneNode(!0)}_handleDeleteCard(){this._element.remove(),this._element=null}_handleLikeCard(){this._likeButtonCard.classList.toggle("elements__like_active")}generateCard(){return this._element=this._getTemplate(),this._elementTitle=this._element.querySelector(".elements__title"),this._elementImage=this._element.querySelector(".elements__image"),this._deleteButtonCard=this._element.querySelector(".elements__basket"),this._likeButtonCard=this._element.querySelector(".elements__like"),this._elementTitle.textContent=this._name,this._elementImage.src=this._link,this._elementImage.alt=this._name,this._deleteButtonCard.addEventListener("click",(()=>{this._handleDeleteCard()})),this._likeButtonCard.addEventListener("click",(()=>{this._handleLikeCard()})),this._elementImage.addEventListener("click",(()=>{this._handleImageClick(this._link,this._name)})),this._element}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._errorText=e.errorText,this._formElement=t,this._submitButtonElement=t.querySelector(e.submitButtonSelector),this._listInputs=Array.from(t.querySelectorAll(e.inputSelector))}enableValidation=()=>{this._setEventListener()};_checkInputValidity=e=>{e.validity.valid?this._hideError(e):this._showError(e)};_hasInvalidInput=()=>this._listInputs.some((e=>!e.validity.valid));buttonSubmitActive=()=>{this._submitButtonElement.classList.remove(this._inactiveButtonClass),this._submitButtonElement.disabled=!1};buttonSubmitNoActive=()=>{this._submitButtonElement.classList.add(this._inactiveButtonClass),this._submitButtonElement.setAttribute("disabled",!0)};toggleButtonState=()=>{this._hasInvalidInput()?this.buttonSubmitNoActive():this.buttonSubmitActive()};_setEventListener=()=>{this.toggleButtonState(),this._listInputs.forEach((e=>{e.addEventListener("input",(()=>{this.toggleButtonState(),this._checkInputValidity(e)}))}))};_showError=e=>{const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)};_hideError=e=>{const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}}const s={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button-save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"error_visible",errorText:".error"},n=document.querySelector("#profile-form"),r=document.querySelector("#card-form"),o=document.querySelector(".profile__button-edit"),i=document.querySelector("#profile-name"),l=document.querySelector("#profile-about"),a=document.querySelector(".profile__button-add"),c=document.querySelector(".elements__cards");class u{constructor(e){this._popupSelector=document.querySelector(e),this._handleClose=this._handleEscClose.bind(this)}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleClose),document.addEventListener("click",this._handleClose)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleClose),document.addEventListener("click",this._handleClose)}_handleEscClose(e){27===e.which&&this.close()}setEventListeners(){const e=this._popupSelector.querySelector(".popup__button-close");this._popupSelector.addEventListener("click",(t=>{t.target.closest(".popup__container")&&t.target!==e||this.close()}))}}class _ extends u{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popupSelector.querySelector(".popup__form")}_getInputValues(){const e=[...this._form.querySelectorAll(".popup__input")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}}a.addEventListener("click",(()=>{b.open(),h.buttonSubmitNoActive()}));const d=t=>new e(t,"#elements__card-template",(()=>{v.open(t.link,t.name)})).generateCard(),p=new class{constructor({items:e,renderer:t},s){this._initialArray=e,this._renderer=t,this._container=s}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=d(e);p.addItem(t)}},c);p.renderItems();const m=new t(s,n);m.enableValidation();const h=new t(s,r);h.enableValidation();const v=new class extends u{open(e,t){super.open();const s=this._popupSelector.querySelector(".popup__card-image"),n=this._popupSelector.querySelector(".popup__subtitle");s.src=e,n.textContent=t}}(".popup_image");v.setEventListeners();const S=new _(".popup_profile",(e=>{const{name:t,job:s}=e;E.setUserInfo(t,s),S.close()}));S.setEventListeners();const b=new _(".popup_card",(e=>{const t=d({name:e.title,link:e.image});p.addItem(t),b.close()}));b.setEventListeners();const E=new class{constructor({profileNameSelector:e,profileJobSelector:t}){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}}({profileNameSelector:".profile__title",profileJobSelector:".profile__subtitle"});o.addEventListener("click",(()=>{const{name:e,job:t}=E.getUserInfo();i.value=e,l.value=t,S.open(),m.buttonSubmitActive()}))})();